# Introduction to the Dynamical Systems Approach to Infectious Disease Epidemiology 


## Overview and Learning Objectives
In this chapter, we discuss the idea of taking a _dynamical systems approach_ and how it is applied to infectious diseases.

The learning objectives for this chapter are:

* Understand the basic ideas of complex systems and systems thinking/modeling
* Assess strength and weaknesses of different approaches to ID dynamics
* Understand the idea of a compartmental model and how it can be used to model infectious diseases
* Know the components of Infectious Disease systems


##Introduction 
While the terminology of _systems thinking_ or _systems approach_ has seen increased use in the last few decades, the general idea has been around for a while. In public health, there is the basic idea - most often applied to infectious diseases - of the *agent - host - environment* system, also referred to as the _epidemiological triangle_ (Figure \@ref(fig:epitriangle)). 

```{r epitriangle,   fig.cap='A system perspective - The epidemiological triangle',  echo=FALSE}
knitr::include_graphics("./images/epi-triangle.png")
```



Similarly, one can think of the basic epidemiological concept of *person - place - time* as describing a system. The notion of a system is present in virtually every field of research, ranging from the hard sciences to social sciences and business. 

The scientific approach that has generally been the most successful in the past was to break down a system into its components and study the components one at a time. Usually referred to as the *reductionistic approach*. This approach to understanding the world is still very powerful and useful. 

A complementary approach, which has seen increased use, is to look at "the whole" system at once, instead of each component at a time. Using the whole system approach can provide insights that might not be obtained by the purely reductionist approach. Looking at the whole system at once is often referred to as _systems thinking/approach_.


##Systems Thinking
The term _systems thinking_ or _systems approach_ or similar such terminology has become popular in various fields during the last few decades. It is not a very clearly defined term, but in general, a _systems_ perspective looks at multiple - often many - components that interact with each other in potentially complicated ways. 

For instance, the problem of obesity has many different components that interact in potentially complex ways to affect a person's weight. Figure \@ref(fig:obesitysystem) illustrates this, see also for instance [this video](https://youtu.be/2vojPksdbtI). Complex systems are everywhere. The approach of studying (most of) the system at once instead of looking at a single component at a time is the hallmark of the _systems approach_. 


```{r obesitysystem,   fig.cap='Obesity as a complex system: http://goo.gl/m2Qq13',  echo=FALSE}
knitr::include_graphics("./images/complexsystem.png")
```



##Classical and Systems ID Epi Approaches
While concepts such as the epidemiological triangle acknowledge that interactions between components are important and determine the behavior of a system, in practice the standard epidemiological approach, based on classical study designs such as cohort, case-control and the randomized trial does not consider system interactions. Indeed, a hallmark assumption of these study designs is that individuals are independent. E.g. the chance that someone in a cohort study has the outcome of interest does not affect the chance of someone else having the outcome. That works well for non-transmissible diseases, and to some extent for transmissible/infectious diseases (we'll use the term infectious disease in the following, mostly meaning diseases that are also transmissible), as long as there are no interactions  (i.e. contact that could lead to transmission) between study subjects. Accounting for interactions between hosts is required to understand important infectious disease concepts such as population level immunity thresholds, critical community size, or indirect effects of interventions. This, in turn, requires a systems approach that explicitly allows for interactions between hosts.

On the research side, the importance of such interactions has long been appreciated and is at the core of the infectious disease modeling paradigm, where one builds and analyzes a system of interacting components (e.g. susceptible and infected hosts). Model based system approaches have a long history in infectious disease epidemiology [@anderson91, @blower04]. The importance of computational methods for the study of infectious diseases continues to increase. In this book, we approach infectious diseases from such a systems thinking perspective, without delving too deeply into the mathematical and computational aspects of the topic. 



##Sytems Thinking and Models
Models are everywhere in science. Models can be conceptual (e.g. graphs or charts), experimental model systems (e.g. a specific mouse strain in immunology) or take the form of mathematical/computer models. 

Once we take the systems perspective, we have to deal with many components that interact in potentially complicated ways. Making study and analysis complicated, especially if we are trying to gain insights into the causal and mechanistic connections between some quantity (exposure) and some outcome. When taking a systems approach, it is therefore often not enough to have a conceptual model alone. While a conceptual approach often allows some qualitative understanding, it is somewhat limiting. It is for instance almost impossible to gain a good *quantitative* understanding how changes in certain conditions and components of a system lead to changes in outcomes of interest by relying on conceptual approaches alone. If we want to go beyond qualitative and move toward a quantitative understanding (i.e. 'increasing the tobacco tax by X% will reduce smoking-related health care costs by Y%'), we need mathematical/computational models. There are many different types of models one can implement. The following provides a - very brief - overview of different modeling approaches.



###Phenomenological (statistical) Models
A huge class of models consists of what we usually refer to as statistical models. In the context of this discussion, I prefer to label them _phenomenological_ models, but that terminology is rarely used. The idea behind the statistical/phenomenological approach is to use a mathematical or computational model to study if there are any patterns between the input (exposure and other variables) and the output (outcomes of interest). 

For instance, a linear regression model investigates if there is a pattern/correlation between input and output that can be well approximated by a linear function. More complicated statistical models exist, some go by the name of _machine learning methods_. All of these models try to determine if there are patterns between inputs and outputs of interest in the data. 

One feature these statistical/phenomenological models have in common is that they do not try to describe the mechanisms of interactions within the system that lead to the observed input-output relations. For instance, if we find that the relationship between the number of cigarettes smoked per day and the 5-year risk of lung cancer can be approximated by a linear function, it does not tell us much about the mechanisms leading from smoking to lung cancer. 


###Mechanistic Models
Another class of models are mechanistic models, which explicitly - albeit usually in very simplified form - try to model the mechanisms of interaction among system components. These models are commonly used for infectious disease studies. For instance, we might want to know how drug dose affects pathogen clearance inside an infected patient. We could collect data on both (such data often needs to come from animal models) and see if a straight line or another kind of model fits the data. Alternatively, we could try to build a model that explicitly captures the mechanism of the drug killing the pathogen, and then see if this mechanistic model describes the data well. The advantage of these kinds of models is that they potentially provide better and deeper understanding of the system. The main disadvantage is that we already need to know (or at least assume) a good bit about how the components interact for us to be able to build such a model. If we don't know what mechanisms might lead to some input impacting some output, we can't build a mechanistic model.

Both phenomenological (statistical) and mechanistic models are useful tools with distinct advantages and disadvantages. Desiding which one to use depends on the question and study system. In this book, we will focus on mechanistic models, which try to represent an explicit, simplified description of the system of interest. 


###Dynamical Systems Thinking/Modeling
The dynamical part adds an explicit time component to the system (and assumes that we can use equations to describe the dynamics). Consider this example: We could study how a change in tobacco taxes might lead to changes in healthcare costs in a given state. Of course, time is present in this system: First we change the taxes, and then we look at changes in costs over some time frame. However, when studying this system, one usually doesn't need to consider an explicitly time-dependent dynamic. Instead one looks at 2 scenarios: Taxes 1 & Costs 1 versus Taxes 2 & Costs 2. It is usually not necessary to model or simulate the chain of events leading from tax change to cost change while explicitly accounting for time.

In contrast, in a dynamical system, the model explicitly changes in time. We might often want to know how certain changes to the system (e.g. interventions) lead to changes in outcomes through a *dynamical/time-dependent* chain of events. For infectious diseases, we most often have some underlying dynamics that we need to take into account (e.g. an ongoing outbreak) and on top of which we might want to implement some interventions. Therefore, the dynamical perspective is often used. Even if a specific disease can be considered to be 'steady' before we implement an intervention (e.g. a given level of TB in a country), there is still disease transmission between individuals happening, which most often makes the dynamical approach more suitable.

We can illustrate this dynamical perspective by extending the epidemiological triangle. Figure \@ref(fig:dynamictriangle) shows the components and the interactions of the triangle changing over time.


```{r dynamictriangle,   fig.cap='Dynamic Epidemiological Triangle. Interactions between agent, host and environment change explicitly with time - indicated by the different coloring for each component and interaction.',  echo=FALSE}
knitr::include_graphics("./images/moving-triangle.png")
```

Mechanistic models are especially well suited to describe dynamical systems and are therefore the primary choice for the study of complex dynamical systems.



###Types of Dynamical, Mechanistic Models
When building mechanistic, dynamical models based on a systems approach, there are two main approaches. In one approach, the model is made up of individual *agents/individuals* and is thus called Agent based or Individual based model. The agents/individuals - which are often but not always are humans - interact with each other. Each agent has certain properties and undergoes certain actions. The interactions of all the agents lead to potentially interesting and complex dynamics. 
Schelling's segregation model (see e.g. [this video](https://youtu.be/dFl3Cfw12bo) ) is a nice example of such an agent based model. Models and approaches that consider individuals connected through networks of contacts are particularly important for infectious diseases, and we'll briefly discuss those in a later chapter.

Another approach simplifies the system by not tracking every individual agent, but instead only keeps track of total agents/individuals in certain states. For instance, for an ecological model, we might track the total numbers of predators and prey (e.g. wolves and sheep). The resulting model is significantly simplified compared to the agent based. If we had a population of a 100, 1000 or 10,000 wolves or sheep, we would need to keep track of as many agents. If we only keep track of the total number of individuals, we only need to track how the numbers in each *compartment* (here wolves and sheep) change - no matter how large our population. Those models, which only track total numbers of individuals, are called *compartmental models*

While these compartmental models are obviously simplifications of the real system, they often retain enough of the model complexity to allow us to study the system in detail. Because of this, the majority of models used in infectious disease epidemiology are still these types of compartmental models. Both the DSAIDE R package and the example models shown in this book focus on such compartmental models. For some more information on compartmental models, [check out this Wikipedia article](https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology)


##A Basic Infectious Disease Systems Model
For infectious disease models, the simplest dynamical systems model keeps track of the total number of individuals who are susceptible, infectious and recovered/immune (the so-called SIR model). This model is a compartmental model, i.e. we place individuals into distinct compartments, according to some characteristics. We then only track the total number of individuals in each of these compartments. In the simplest model, the only characteristic we track is a person's infection status according to 3 different stages/compartments: 

* **S** - uninfected and susceptible individuals. 
* **I** - infected and infectious individuals (note that these terms are often used interchangeably, but technically we are talking about someone who is infected **and** is infectious, i.e. can infect others).
* **R** - recovered/removed individuals. Those are individuals that do not further participate, either because they are now immune or because they died.

In addition to specifying the **compartments** of a model, we need to specify the **processes/mechanisms** determining the changes in each compartment. Broadly speaking, some processes increase the number of individuals in a given compartment/stage and processes that lead to a reduction. Those processes are sometimes called inflows and outflows. 

For our system, we specify only 2 processes/flows: 

1. A susceptible individual (S) can become infected by an infectious individual (I) at some rate (for which we use the parameter _b_). This leads to the susceptible individual leaving the S compartment and entering the I compartment.   
2. An infected individual dies or recovers and enters the recovered/removed (R) compartment at some rate. This is described by the parameter _g_ in our model.

The SIR model is very basic, but it still has the hallmark of a complex system. Specifically, there is an interaction between components, namely the **I** "component" interacts with the **S** component, or phrased in more ordinary language, infected individuals can interact with susceptibles and thereby infect them. 

For compartmental models (and often other types of models), it is useful to show a graphical representation of the compartments and processes included in the model. For compartmental models, such a diagram/figure is usually called a flow diagram. Such a diagram consists of a box for each compartment, and arrows pointing in and out of boxes to describe flows and interactions. For the simple SIR model, the flow diagram is shown in Figure \@ref(fig:basicSIR).

```{r basicSIR, fig.cap='Flow diagram for the simple SIR model.',  echo=FALSE}
knitr::include_graphics("./images/basicSIRmodelfigure.png")
```


#### Model Implementation {#myadvancedbox}
If one wants to study any model in detail, one needs to implement it either in the form of a mathematical or a computer model (or both). For compartmental models, the most common way of implementation is writing the model as a set of ordinary differential equations and implementing those in some computer language. This book shows sets of ODE equations for the several of the discussed models, but a detailed understanding of these equations is not required to understand the different topics we discuss. For the model described above, the equations look like this: 
$$\dot S = -bSI$$
$$\dot I = bSI - gI$$
$$\dot R = gI$$

We are using the usual short-hand notation, where a dot over a variable means its derivative (its change) with respect to time. In all the models we consider, we always only consider changes with respect to time (the dynamical aspect of the model).


##Some General Comments and Notes
In general, the entities that change (that vary) in our system (here the number of individuals in compartments S, I and R) are called variables and are each given a compartment/equation. In contrast, the quantities that are usually assumed fixed for a given system are called parameters. For the model above, those are the infection rate _b_ and the recovery rate _g_. This is not a fixed rule, though and sometimes, parameters can be allowed to vary.

When talking about the quantities that are tracked in each compartment, you will see both the term *host(s)* and *individual(s)* used interchangeably. While we most often think of human hosts, the hosts can be any animal (or plants or bacteria infected by phages, etc.). Sometimes, a compartment might track an entity such as pathogen load in the environment. 

If you want to study a specific ID, you choose parameters such that they match the specific disease you want to study. We'll return to that idea throughout this book.

Unfortunately, there are no rules concerning the naming of variables and parameters. Compartments (e.g. SIR) tend to be labeled very similarly by different researchers, while parameter labels are much more variable. I'm trying to be consistent in this book, though I might mix it up occasionally. For this book, I decided to stick with letters from the English alphabet, but you can often find people use Greek letters for parameters (e.g. $\beta$ instead of _b_ for the transmission parameter). Always check carefully for a given paper/model what the definition and meaning of each variable and parameter are. 


##Summary and Cartoon
This chapter provided a brief introduction to the concept of systems thinking and how modeling is used to study complex systems. We briefly looked at a simple infectious disease systems model, the famous SIR model. 


```{r complexcartoon, fig.cap='Not every diagram helps to understand a complex system. [Source: xkcd.com](https://xkcd.com/1488/).',  echo=FALSE}
knitr::include_graphics("./images/xkcd-flowcharts.png")
```

##Exercises
* Work through the tasks for the _ID Dynamics Introduction_ DSAIDE app.
* Contemplate on your experience with the _ID Dynamics Introduction_ DSAIDE app. In which way does it capture the 'dynamical systems' perspective? Did you find any behavior of this - arguably still very simple - infectious disease model/system that you would consider as being "complex"? How/why?
* Read the paper "Systems Science Methods in Public Health: Dynamics, Networks, and Agents" by Luke & Stamatakis [@luke12]. Come up with 2 systems that you consider complex in the realm of public health or biomedicine (other than those mentioned in the paper). Explain what makes them complex. Also, come up with 2 systems that you consider not complex and explain why you think of them as not complex.


##Further Resources
* The paper "Why Model?" by Joshua Epstein [@epstein08] provides a nice, short discussion of the purposes of models. Other general introductory discussions of systems thinking and model use are [@may04; @chubb10; @garnett11; @basu13; @gunawardena14; @homer06; @peters14; @sterman06].
* Several introductory papers on infectious disease modeling can be found in e.g. [@keeling09; @heesterbeek15; @lessler16; @metcalf17].
* While the dynamical systems approach has been applied to infectious diseases for a long time, it is starting to be used more frequently in other areas of public health. Some recent references on that topic are e.g. [@ness07; @sanchez-romero16].

##References

